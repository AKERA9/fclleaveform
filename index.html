<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.tailwindcss.com"></script>

<script>
tailwind.config = {
  theme: {
    extend: {
      colors: {
        'primary-red': '#D40000',
        'primary-dark-red': '#A30000',
        'success-green': '#10B981',
      }
    }
  }
}
</script>

<style>
.success-message { display:none }
</style>
</head>

<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">

<div id="formBox" class="bg-white w-full max-w-md p-6 rounded-xl shadow-xl border-t-8 border-primary-red">
  <h2 class="text-2xl font-bold text-center mb-4">Leave Request</h2>

  <form id="leaveForm" class="space-y-4">

    <select name="name" required class="w-full p-3 border rounded">
      <option value="" disabled selected>-- Select Name --</option>
      <option>Aakash</option>
      <option>Rajmati</option>
      <option>Deepak</option>
      <option>Rakesh</option>
      <option>Vedraaj</option>
    </select>

    <input type="date" name="date" id="date" required class="w-full p-3 border rounded">

    <select name="day" id="day" required class="w-full p-3 border rounded">
      <option disabled selected>-- Day --</option>
      <option>Monday</option>
      <option>Tuesday</option>
      <option>Wednesday</option>
      <option>Thursday</option>
      <option>Friday</option>
      <option>Saturday</option>
    </select>

    <textarea name="reason" required placeholder="Reason" class="w-full p-3 border rounded"></textarea>

    <button id="submitBtn" class="w-full bg-primary-red text-white py-3 rounded font-bold">
      Submit & Open WhatsApp
    </button>
  </form>
</div>

<!-- SUCCESS POPUP -->
<div id="success" class="fixed inset-0 bg-black/40 hidden items-center justify-center">
  <div class="bg-white p-6 rounded-xl text-center">
    <div class="text-green-600 text-4xl mb-2">âœ”</div>
    <p class="font-bold mb-3">Data Google Sheet me save ho gaya</p>
    <a id="waBtn" target="_blank" class="block bg-green-500 text-white px-4 py-2 rounded mb-2">
      Open WhatsApp
    </a>
    <button onclick="closePopup()" class="text-gray-600">Close</button>
  </div>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbw2ZXcLdc5oYuSXkqtuTeW-KF8oaWJD9uiJgiSXxWyB3MVI-5EndEuUVF7oXwtn9W-F7g/exec";
const WA_NUMBER = "919711220917";

const form = document.getElementById("leaveForm");
const success = document.getElementById("success");
const waBtn = document.getElementById("waBtn");
const dayField = document.getElementById("day");
const dateField = document.getElementById("date");

const days = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];

dateField.value = new Date().toISOString().split("T")[0];
updateDay();

dateField.addEventListener("change", updateDay);

function updateDay(){
  const d = new Date(dateField.value).getDay();
  if(days[d] !== "Sunday") dayField.value = days[d];
}

form.addEventListener("submit", e => {
  e.preventDefault();

  const data = Object.fromEntries(new FormData(form).entries());

  const text =
`*Leave Request*
Name: ${data.name}
Date: ${data.date}
Day: ${data.day}
Reason: ${data.reason}`;

  const waLink = `https://wa.me/${WA_NUMBER}?text=${encodeURIComponent(text)}`;

  fetch(SCRIPT_URL, {
    method: "POST",
    body: JSON.stringify(data),
    headers: { "Content-Type": "application/json" }
  })
  .then(() => {
    waBtn.href = waLink;
    window.open(waLink, "_blank");
    success.classList.remove("hidden");
    success.classList.add("flex");
    form.reset();
  })
  .catch(() => {
    alert("Sheet error, WhatsApp open ho raha hai");
    window.open(waLink, "_blank");
  });
});

function closePopup(){
  success.classList.add("hidden");
}
</script>

</body>
</html>

